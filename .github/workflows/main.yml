name: Run PTT Scraper

# 1. 設定觸發時間
on:
  schedule:
    # 這裡使用 Cron 表達式，設定為每天凌晨 0 點 (UTC+0)，約台灣時間早上 8 點
    - cron: '0 0 * * *'
  workflow_dispatch: # 讓你可以手動點擊按鈕來執行，方便測試

jobs:
  build:
    runs-on: ubuntu-latest # 使用最新的 Linux 環境

    steps:
    # 2. 檢出程式碼 (把你的專案下載到這台雲端電腦)
    - name: Checkout repository
      uses: actions/checkout@v3

    # 3. 安裝 Python 環境
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'

    # 4. 安裝爬蟲需要的套件
    - name: Install dependencies
      run: |
        pip install requests beautifulsoup4

    # 5. 執行爬蟲腳本
    - name: Run scraper
      run: python scraper.py

    # 6. 將更新後的 ptt_game.json 存回 GitHub
    - name: Commit and push changes
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git add ptt_game.json
        git commit -m "Auto update PTT data: $(date)" || echo "No changes to commit"
        git push
